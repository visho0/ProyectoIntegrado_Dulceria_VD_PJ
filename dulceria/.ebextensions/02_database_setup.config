# Configuración para ejecutar migraciones y crear categorías después del despliegue
# Este script se ejecuta SOLO en la instancia líder (leader_only: true)

container_commands:
  01_migrate:
    command: "source /var/app/venv/*/bin/activate && cd /var/app/current && python manage.py migrate --noinput"
    leader_only: true
    ignoreErrors: false
  
  02_create_categories:
    command: "source /var/app/venv/*/bin/activate && cd /var/app/current && python manage.py create_categorias_dulces || true"
    leader_only: true
    ignoreErrors: true
    # ignoreErrors: true porque si las categorías ya existen, el comando fallará pero eso está bien
  
  03_generate_test_data:
    command: "source /var/app/venv/*/bin/activate && cd /var/app/current && python manage.py generate_test_data --proveedores 5000 --productos 10000 --movimientos 10000 || true"
    leader_only: true
    ignoreErrors: true
    # ignoreErrors: true porque si los datos ya existen, no es crítico
    # Esto generará los datos de prueba para stress test

option_settings:
  aws:elasticbeanstalk:container:python:
    WSGIPath: dulceria/wsgi.py

